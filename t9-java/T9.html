<html><head><title>T9</title></head><body  ><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>The old fashioned king does not know how to SMS and thus he is having problems sending messages to the queen. In particular, he is having a problem with a feature called T9.<br></br>
<br></br>
In T9, the set of alphabets are partitioned into 9 sets, where the i-th set of characters (1-based) denotes the possible characters that may be typed by pressing digit i. For this problem, we will use strings to denote a set of characters. On a standard modern cell phone, the following partition is used<br></br>
<pre>
	{"", "abc", "def", "ghi", "jkl", "mno", "pqrs", "tuv", "wxyz"}
</pre>
For the partition above, pressing 2 may output 'a', 'b' or 'c'; pressing 3 may output 'd', 'e' or 'f'; and so on. Pressing 223 can give you various outputs of the form "(abc)(abc)(def)" where (XYZ) means that the letter can be either X or Y or Z. For example, a few possible outputs are "ace", "bad" and "bbe".<br></br>
<br></br>
However, not all possible outputs are dictionary words (like "bbe" is not a dictionary word), and thus these outputs do not make sense. The cell phone considers only those outputs which correspond to dictionary words. Suppose that there are only two possible dictionary words from "(abc)(abc)(def)" - namely, "ace" and "bad". Then, the keystrokes 223 gives the output "ace", and the keystrokes 223# gives the output "bad". In general if a certain number (like 223) corresponds to multiple dictionary words, then the number followed by n hashes ('#') is used to type the n-th dictionary word (0-based) from the lexographically sorted list of dictionary words corresponding to the number. Sometimes the number of hashes typed can be quite large. Hence, we have a special character star ('*') which is equivalent to 5 contiguous hashes. The digit 0 is used to type a space.<br></br>
<br></br>
The king needs to type a text using T9. The text is a String that consists of lowercase letters ('a'-'z') and space characters (' '). A word is a maximal contiguous substring of the text that contains only lowercase letters ('a'-'z'). The only way the king can type a word is by first pressing a non-empty sequence of digits ('1'-'9') followed by a (possibly emtpy) sequence of characters '#' and/or '*'.

You will be given a String[] <b>part</b> whose i-th element (1-based) is the set of alphabets which correspond to the digit i. You will also be given a String[] <b>dict</b> that represents a set of all dictionary words, where each element is a single word. Finally, you will be given a String[] <b>keystr</b>. Concatenate the elements of <b>keystr</b> in the same order as they are given to obtain a String. This String represents the keystrokes pressed by the king. To help the king, return the text that will result when the given keystrokes are pressed. You may assume that the given keystrokes are valid, i.e. each maximal contiguous substring that doesn't contain '0' characters starts from non-empty sequence of digits ('1'-'9') and then is optionally continued with a sequence of '#' and/or '*' characters. You may also assume that each such substring corresponds to a word from <b>dict</b>.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>T9</td></tr><tr><td>Method:</td><td>message</td></tr><tr><td>Parameters:</td><td>String[], String[], String[]</td></tr><tr><td>Returns:</td><td>String</td></tr><tr><td>Method signature:</td><td>String message(String[] part, String[] dict, String[] keystr)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td>&#160;&#160;&#160;&#160;</td></tr><tr><td></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>A substring of a String is called <i>maximal</i> with respect to some property if it can't be extended to the left or to the right while maintaining the property.</td></tr><tr><td align="center" valign="top">-</td><td>A string A is lexicographically less than another string B of the same length if there exists a position i such that each character of A before the i-th position is equal to the character at the corresponding position in B, and A[i] is less than B[i].</td></tr><tr><td align="center" valign="top">-</td><td>For the purpose of this problem, a partition of alphabets into 9 sets may contain any number of empty sets.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>part</b> will represent a valid partition of the 26 english alphabets into 9 sets, i.e. it will consist of exactly 9 elements and every letter from 'a' to 'z' will appear exactly once in exactly one of the elements of <b>part</b>.</td></tr><tr><td align="center" valign="top">-</td><td><b>dict</b> will contain between 1 and 50 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>dict</b> will contain between 1 and 50 characters, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each character in <b>dict</b> will be a lowercase letter 'a'-'z'.</td></tr><tr><td align="center" valign="top">-</td><td>All elements of <b>dict</b> will be distinct.</td></tr><tr><td align="center" valign="top">-</td><td><b>keystr</b> will contain between 1 and 50 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>keystr</b> will contain between 1 and 50 characters, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each character in <b>keystr</b> will be one of '0'-'9', '#', '*'.</td></tr><tr><td align="center" valign="top">-</td><td>The length of the resulting text will be between 1 and 1000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>The String obtained by concatenating the elements of <b>keystr</b> will represent a valid sequence of keystrokes (as explained in the statement).</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;&quot;, &quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;, &quot;jkl&quot;, &quot;mno&quot;, &quot;pqrs&quot;, &quot;tuv&quot;, &quot;wxyz&quot;}</pre></td></tr><tr><td><pre>{&quot;bad&quot;}</pre></td></tr><tr><td><pre>{&quot;2230223&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot;bad bad&quot;</pre></td></tr><tr><td></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;&quot;, &quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;, &quot;jkl&quot;, &quot;mno&quot;, &quot;pqrs&quot;, &quot;tuv&quot;, &quot;wxyz&quot;}</pre></td></tr><tr><td><pre>{&quot;the&quot;, &quot;tie&quot;}</pre></td></tr><tr><td><pre>{&quot;0843#000843#000&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot; tie   tie   &quot;</pre></td></tr><tr><td><table><tr><td colspan="2">There may be leading, trailing and contiguous spaces.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;&quot;, &quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;, &quot;jkl&quot;, &quot;mno&quot;, &quot;pqrs&quot;, &quot;tuv&quot;, &quot;wxyz&quot;}</pre></td></tr><tr><td><pre>{&quot;bad&quot;, &quot;ace&quot;, &quot;aad&quot;, &quot;aae&quot;, &quot;aaf&quot;, &quot;acf&quot;, &quot;acd&quot;, &quot;the&quot;, &quot;tie&quot;}</pre></td></tr><tr><td><pre>{&quot;223#02&quot;, &quot;23*#00843#0&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot;aae bad  tie &quot;</pre></td></tr><tr><td><table><tr><td colspan="2">Don't forget to concatenate the elements of <b>keystr</b>. Also, "*" is equivalent to "#####".</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;&quot;, &quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;, &quot;jkl&quot;, &quot;mno&quot;, &quot;pqrs&quot;, &quot;tuv&quot;, &quot;wxyz&quot;}</pre></td></tr><tr><td><pre>{&quot;the&quot;, &quot;tie&quot;, &quot;bad&quot;, &quot;ace&quot;, &quot;aad&quot;, &quot;aae&quot;, &quot;aaf&quot;, &quot;acf&quot;, &quot;acd&quot;}</pre></td></tr><tr><td><pre>{&quot;84300223#02&quot;, &quot;23#*&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot;the  aae bad&quot;</pre></td></tr><tr><td><table><tr><td colspan="2">'*' may also appear after the '#'. All that matters is, it is equivalent to "#####".</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;&quot;, &quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;, &quot;jkl&quot;, &quot;mno&quot;, &quot;pqrs&quot;, &quot;tuv&quot;, &quot;wxyz&quot;}</pre></td></tr><tr><td><pre>{&quot;bad&quot;, &quot;ace&quot;, &quot;aad&quot;, &quot;aae&quot;, &quot;tie&quot;, &quot;aaf&quot;, &quot;acf&quot;, &quot;acd&quot;, &quot;the&quot;}</pre></td></tr><tr><td><pre>{&quot;223#02&quot;, &quot;23######&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot;aae bad&quot;</pre></td></tr><tr><td><table><tr><td colspan="2">The king may use '*'. But it is not necessary that he uses it everytime he is allowed to use it. </td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;&quot;, &quot;rq&quot;, &quot;lde&quot;, &quot;yoauz&quot;, &quot;cbfgn&quot;, &quot;tjkpx&quot;, &quot;wvs&quot;, &quot;ih&quot;, &quot;m&quot;}</pre></td></tr><tr><td><pre>{&quot;xktgmfmoqlmivm&quot;,
 &quot;hmthr&quot;,
 &quot;tpjgmnmaremiwm&quot;,
 &quot;tpjcmnmyrlmhvm&quot;,
 &quot;xkpnmgmzqdmhsm&quot;,
 &quot;wqopvvmiig&quot;,
 &quot;melbcbqeeg&quot;,
 &quot;jkxnmbmardmhwm&quot;,
 &quot;kpxnmcmyqlmism&quot;,
 &quot;wrztvsmhhf&quot;,
 &quot;srztssmiic&quot;,
 &quot;pxtgmfmyrdmhwm&quot;,
 &quot;vqoxswmiin&quot;,
 &quot;wryksvmihb&quot;,
 &quot;ptjfmbmoremhvm&quot;}</pre></td></tr><tr><td><pre>{&quot;00&quot;,
 &quot;7246779885##00000089682000007246779885##0000724677&quot;,
 &quot;9885#000089682000093355523350066659594239879###000&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns:
&quot;  wqopvvmiig      hmthr     wqopvvmiig    vqoxswmiin    hmthr    melbcbqeeg  pxtgmfmyrdmhwm   &quot;</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
